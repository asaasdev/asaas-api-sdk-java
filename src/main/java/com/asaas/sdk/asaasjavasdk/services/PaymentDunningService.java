// This file was generated by liblab | https://liblab.com/

package com.asaas.sdk.asaasjavasdk.services;

import com.asaas.sdk.asaasjavasdk.config.AsaasSdkConfig;
import com.asaas.sdk.asaasjavasdk.exceptions.ApiError;
import com.asaas.sdk.asaasjavasdk.exceptions.ApiErrorResponseDto;
import com.asaas.sdk.asaasjavasdk.http.Environment;
import com.asaas.sdk.asaasjavasdk.http.HttpMethod;
import com.asaas.sdk.asaasjavasdk.http.ModelConverter;
import com.asaas.sdk.asaasjavasdk.http.util.RequestBuilder;
import com.asaas.sdk.asaasjavasdk.models.ApiErrorResponseDtoModel;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningCancelRequestDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningCancelResponseDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningListHistoryResponseDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningListPartialPaymentsResponseDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningListResponseDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningPaymentsAvailableForDunningResponseDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningSaveDocumentsRequestDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningSaveDocumentsResponseDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningSaveRequestDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningSaveRequestPaymentDunningType;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningShowResponseDto;
import com.asaas.sdk.asaasjavasdk.models.ApiPaymentDunningSimulateResponseDto;
import com.asaas.sdk.asaasjavasdk.models.EventHistoryListsParameters;
import com.asaas.sdk.asaasjavasdk.models.ListPaymentDunningsParameters;
import com.asaas.sdk.asaasjavasdk.models.ListPaymentsAvailableForPaymentDunningParameters;
import com.asaas.sdk.asaasjavasdk.models.ListPaymentsReceivedParameters;
import com.asaas.sdk.asaasjavasdk.models.SimulateAPaymentDunningParameters;
import com.asaas.sdk.asaasjavasdk.validation.ViolationAggregator;
import com.asaas.sdk.asaasjavasdk.validation.exceptions.ValidationException;
import com.asaas.sdk.asaasjavasdk.validation.validators.modelValidators.EventHistoryListsParametersValidator;
import com.asaas.sdk.asaasjavasdk.validation.validators.modelValidators.ListPaymentDunningsParametersValidator;
import com.asaas.sdk.asaasjavasdk.validation.validators.modelValidators.ListPaymentsAvailableForPaymentDunningParametersValidator;
import com.asaas.sdk.asaasjavasdk.validation.validators.modelValidators.ListPaymentsReceivedParametersValidator;
import com.fasterxml.jackson.core.type.TypeReference;
import java.util.Optional;
import java.util.UUID;
import java.util.concurrent.CompletableFuture;
import lombok.NonNull;
import okhttp3.MediaType;
import okhttp3.MultipartBody;
import okhttp3.OkHttpClient;
import okhttp3.Request;
import okhttp3.RequestBody;
import okhttp3.Response;

/**
 * PaymentDunningService Service
 */
public class PaymentDunningService extends BaseService {

  public PaymentDunningService(@NonNull OkHttpClient httpClient, AsaasSdkConfig config) {
    super(httpClient, config);
  }

  /**
   * List payment dunnings
   *
   * @return response of {@code ApiPaymentDunningListResponseDto}
   */
  public ApiPaymentDunningListResponseDto listPaymentDunnings() throws ApiError, ValidationException {
    return this.listPaymentDunnings(ListPaymentDunningsParameters.builder().build());
  }

  /**
   * List payment dunnings
   *
   * @param requestParameters {@link ListPaymentDunningsParameters} Request Parameters Object
   * @return response of {@code ApiPaymentDunningListResponseDto}
   */
  public ApiPaymentDunningListResponseDto listPaymentDunnings(@NonNull ListPaymentDunningsParameters requestParameters)
    throws ApiError, ValidationException {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildListPaymentDunningsRequest(requestParameters);
    Response response = this.execute(request);
    return ModelConverter.convert(response, new TypeReference<ApiPaymentDunningListResponseDto>() {});
  }

  /**
   * List payment dunnings
   *
   * @return response of {@code CompletableFuture<ApiPaymentDunningListResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningListResponseDto> listPaymentDunningsAsync()
    throws ApiError, ValidationException {
    return this.listPaymentDunningsAsync(ListPaymentDunningsParameters.builder().build());
  }

  /**
   * List payment dunnings
   *
   * @param requestParameters {@link ListPaymentDunningsParameters} Request Parameters Object
   * @return response of {@code CompletableFuture<ApiPaymentDunningListResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningListResponseDto> listPaymentDunningsAsync(
    @NonNull ListPaymentDunningsParameters requestParameters
  ) throws ApiError, ValidationException {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildListPaymentDunningsRequest(requestParameters);
    CompletableFuture<Response> futureResponse = this.executeAsync(request);
    return futureResponse.thenApplyAsync(response ->
      ModelConverter.convert(response, new TypeReference<ApiPaymentDunningListResponseDto>() {})
    );
  }

  private Request buildListPaymentDunningsRequest(@NonNull ListPaymentDunningsParameters requestParameters)
    throws ValidationException {
    new ViolationAggregator()
      .add(new ListPaymentDunningsParametersValidator("requestParameters").optional().validate(requestParameters))
      .validateAll();
    RequestBuilder builder = new RequestBuilder(
      HttpMethod.GET,
      Optional.ofNullable(this.config.getBaseUrl()).orElse(Environment.DEFAULT.getUrl()),
      "v3/paymentDunnings"
    )
      .setApiKeyAuth(this.config.getApiKeyAuthConfig())
      .setOptionalQueryParameter("offset", requestParameters.getOffset())
      .setOptionalQueryParameter("limit", requestParameters.getLimit())
      .setOptionalQueryParameter("payment", requestParameters.getPayment())
      .setOptionalQueryParameter("requestStartDate", requestParameters.getRequestStartDate())
      .setOptionalQueryParameter("requestEndDate", requestParameters.getRequestEndDate());
    if (requestParameters.getStatus() != null) {
      builder.setOptionalQueryParameter("status", requestParameters.getStatus().getValue());
    }
    if (requestParameters.getType() != null) {
      builder.setOptionalQueryParameter("type", requestParameters.getType().getValue());
    }
    return builder.build();
  }

  /**
   * Create a payment dunning
   *
   * @return response of {@code ApiPaymentDunningShowResponseDto}
   */
  public ApiPaymentDunningShowResponseDto createAPaymentDunning() throws ApiError {
    return this.createAPaymentDunning(ApiPaymentDunningSaveRequestDto.builder().build(), null);
  }

  /**
   * Create a payment dunning
   *
   * @param apiPaymentDunningSaveRequestDto {@link ApiPaymentDunningSaveRequestDto} Request Body
   * @return response of {@code ApiPaymentDunningShowResponseDto}
   */
  public ApiPaymentDunningShowResponseDto createAPaymentDunning(
    @NonNull ApiPaymentDunningSaveRequestDto apiPaymentDunningSaveRequestDto
  ) throws ApiError {
    return this.createAPaymentDunning(apiPaymentDunningSaveRequestDto, null);
  }

  /**
   * Create a payment dunning
   *
   * @param apiPaymentDunningSaveRequestDto {@link ApiPaymentDunningSaveRequestDto} Request Body
   * @param _filename String Filename for the uploaded file
   * @return response of {@code ApiPaymentDunningShowResponseDto}
   */
  public ApiPaymentDunningShowResponseDto createAPaymentDunning(
    @NonNull ApiPaymentDunningSaveRequestDto apiPaymentDunningSaveRequestDto,
    String _filename
  ) throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildCreateAPaymentDunningRequest(apiPaymentDunningSaveRequestDto, _filename);
    Response response = this.execute(request);
    return ModelConverter.convert(response, new TypeReference<ApiPaymentDunningShowResponseDto>() {});
  }

  /**
   * Create a payment dunning
   *
   * @return response of {@code CompletableFuture<ApiPaymentDunningShowResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningShowResponseDto> createAPaymentDunningAsync() throws ApiError {
    return this.createAPaymentDunningAsync(ApiPaymentDunningSaveRequestDto.builder().build(), null);
  }

  /**
   * Create a payment dunning
   *
   * @param apiPaymentDunningSaveRequestDto {@link ApiPaymentDunningSaveRequestDto} Request Body
   * @return response of {@code CompletableFuture<ApiPaymentDunningShowResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningShowResponseDto> createAPaymentDunningAsync(
    @NonNull ApiPaymentDunningSaveRequestDto apiPaymentDunningSaveRequestDto
  ) throws ApiError {
    return this.createAPaymentDunningAsync(apiPaymentDunningSaveRequestDto, null);
  }

  /**
   * Create a payment dunning
   *
   * @param apiPaymentDunningSaveRequestDto {@link ApiPaymentDunningSaveRequestDto} Request Body
   * @param _filename String Filename for the uploaded file
   * @return response of {@code CompletableFuture<ApiPaymentDunningShowResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningShowResponseDto> createAPaymentDunningAsync(
    @NonNull ApiPaymentDunningSaveRequestDto apiPaymentDunningSaveRequestDto,
    String _filename
  ) throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildCreateAPaymentDunningRequest(apiPaymentDunningSaveRequestDto, _filename);
    CompletableFuture<Response> futureResponse = this.executeAsync(request);
    return futureResponse.thenApplyAsync(response ->
      ModelConverter.convert(response, new TypeReference<ApiPaymentDunningShowResponseDto>() {})
    );
  }

  private Request buildCreateAPaymentDunningRequest(
    @NonNull ApiPaymentDunningSaveRequestDto apiPaymentDunningSaveRequestDto,
    String _filename
  ) {
    MultipartBody.Builder multipartBodyBuilder = new MultipartBody.Builder()
      .setType(MultipartBody.FORM)
      .addFormDataPart("payment", apiPaymentDunningSaveRequestDto.getPayment())
      .addFormDataPart("type", apiPaymentDunningSaveRequestDto.getType().getValue())
      .addFormDataPart("description", apiPaymentDunningSaveRequestDto.getDescription())
      .addFormDataPart("customerName", apiPaymentDunningSaveRequestDto.getCustomerName())
      .addFormDataPart("customerCpfCnpj", apiPaymentDunningSaveRequestDto.getCustomerCpfCnpj())
      .addFormDataPart("customerPrimaryPhone", apiPaymentDunningSaveRequestDto.getCustomerPrimaryPhone())
      .addFormDataPart("customerSecondaryPhone", apiPaymentDunningSaveRequestDto.getCustomerSecondaryPhone())
      .addFormDataPart("customerPostalCode", apiPaymentDunningSaveRequestDto.getCustomerPostalCode())
      .addFormDataPart("customerAddress", apiPaymentDunningSaveRequestDto.getCustomerAddress())
      .addFormDataPart("customerAddressNumber", apiPaymentDunningSaveRequestDto.getCustomerAddressNumber())
      .addFormDataPart("customerComplement", apiPaymentDunningSaveRequestDto.getCustomerComplement())
      .addFormDataPart("customerProvince", apiPaymentDunningSaveRequestDto.getCustomerProvince());
    if (apiPaymentDunningSaveRequestDto.getDocuments() != null) {
      multipartBodyBuilder.addFormDataPart(
        "documents",
        _filename != null ? _filename : String.format("file_%s", UUID.randomUUID()),
        RequestBody.create(apiPaymentDunningSaveRequestDto.getDocuments(), MediaType.parse("application/octet-stream"))
      );
    }
    return new RequestBuilder(
      HttpMethod.POST,
      Optional.ofNullable(this.config.getBaseUrl()).orElse(Environment.DEFAULT.getUrl()),
      "v3/paymentDunnings"
    )
      .setApiKeyAuth(this.config.getApiKeyAuthConfig())
      .setBody(multipartBodyBuilder.build())
      .build();
  }

  /**
   * Simulate a payment dunning
   *
   * @return response of {@code ApiPaymentDunningSimulateResponseDto}
   */
  public ApiPaymentDunningSimulateResponseDto simulateAPaymentDunning() throws ApiError {
    return this.simulateAPaymentDunning(SimulateAPaymentDunningParameters.builder().build());
  }

  /**
   * Simulate a payment dunning
   *
   * @param requestParameters {@link SimulateAPaymentDunningParameters} Request Parameters Object
   * @return response of {@code ApiPaymentDunningSimulateResponseDto}
   */
  public ApiPaymentDunningSimulateResponseDto simulateAPaymentDunning(
    @NonNull SimulateAPaymentDunningParameters requestParameters
  ) throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildSimulateAPaymentDunningRequest(requestParameters);
    Response response = this.execute(request);
    return ModelConverter.convert(response, new TypeReference<ApiPaymentDunningSimulateResponseDto>() {});
  }

  /**
   * Simulate a payment dunning
   *
   * @return response of {@code CompletableFuture<ApiPaymentDunningSimulateResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningSimulateResponseDto> simulateAPaymentDunningAsync() throws ApiError {
    return this.simulateAPaymentDunningAsync(SimulateAPaymentDunningParameters.builder().build());
  }

  /**
   * Simulate a payment dunning
   *
   * @param requestParameters {@link SimulateAPaymentDunningParameters} Request Parameters Object
   * @return response of {@code CompletableFuture<ApiPaymentDunningSimulateResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningSimulateResponseDto> simulateAPaymentDunningAsync(
    @NonNull SimulateAPaymentDunningParameters requestParameters
  ) throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildSimulateAPaymentDunningRequest(requestParameters);
    CompletableFuture<Response> futureResponse = this.executeAsync(request);
    return futureResponse.thenApplyAsync(response ->
      ModelConverter.convert(response, new TypeReference<ApiPaymentDunningSimulateResponseDto>() {})
    );
  }

  private Request buildSimulateAPaymentDunningRequest(@NonNull SimulateAPaymentDunningParameters requestParameters) {
    return new RequestBuilder(
      HttpMethod.POST,
      Optional.ofNullable(this.config.getBaseUrl()).orElse(Environment.DEFAULT.getUrl()),
      "v3/paymentDunnings/simulate"
    )
      .setApiKeyAuth(this.config.getApiKeyAuthConfig())
      .setOptionalQueryParameter("payment", requestParameters.getPayment())
      .setJsonContent(requestParameters.getApiPaymentDunningSimulateRequestDto())
      .build();
  }

  /**
   * Recover a single payment dunning
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @return response of {@code ApiPaymentDunningShowResponseDto}
   */
  public ApiPaymentDunningShowResponseDto recoverASinglePaymentDunning(@NonNull String id) throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildRecoverASinglePaymentDunningRequest(id);
    Response response = this.execute(request);
    return ModelConverter.convert(response, new TypeReference<ApiPaymentDunningShowResponseDto>() {});
  }

  /**
   * Recover a single payment dunning
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @return response of {@code CompletableFuture<ApiPaymentDunningShowResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningShowResponseDto> recoverASinglePaymentDunningAsync(@NonNull String id)
    throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildRecoverASinglePaymentDunningRequest(id);
    CompletableFuture<Response> futureResponse = this.executeAsync(request);
    return futureResponse.thenApplyAsync(response ->
      ModelConverter.convert(response, new TypeReference<ApiPaymentDunningShowResponseDto>() {})
    );
  }

  private Request buildRecoverASinglePaymentDunningRequest(@NonNull String id) {
    return new RequestBuilder(
      HttpMethod.GET,
      Optional.ofNullable(this.config.getBaseUrl()).orElse(Environment.DEFAULT.getUrl()),
      "v3/paymentDunnings/{id}"
    )
      .setApiKeyAuth(this.config.getApiKeyAuthConfig())
      .setPathParameter("id", id)
      .build();
  }

  /**
   * Event history lists
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @param requestParameters {@link EventHistoryListsParameters} Request Parameters Object
   * @return response of {@code ApiPaymentDunningListHistoryResponseDto}
   */
  public ApiPaymentDunningListHistoryResponseDto eventHistoryLists(
    @NonNull String id,
    @NonNull EventHistoryListsParameters requestParameters
  ) throws ApiError, ValidationException {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildEventHistoryListsRequest(id, requestParameters);
    Response response = this.execute(request);
    return ModelConverter.convert(response, new TypeReference<ApiPaymentDunningListHistoryResponseDto>() {});
  }

  /**
   * Event history lists
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @param requestParameters {@link EventHistoryListsParameters} Request Parameters Object
   * @return response of {@code CompletableFuture<ApiPaymentDunningListHistoryResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningListHistoryResponseDto> eventHistoryListsAsync(
    @NonNull String id,
    @NonNull EventHistoryListsParameters requestParameters
  ) throws ApiError, ValidationException {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildEventHistoryListsRequest(id, requestParameters);
    CompletableFuture<Response> futureResponse = this.executeAsync(request);
    return futureResponse.thenApplyAsync(response ->
      ModelConverter.convert(response, new TypeReference<ApiPaymentDunningListHistoryResponseDto>() {})
    );
  }

  private Request buildEventHistoryListsRequest(
    @NonNull String id,
    @NonNull EventHistoryListsParameters requestParameters
  ) throws ValidationException {
    new ViolationAggregator()
      .add(new EventHistoryListsParametersValidator("requestParameters").optional().validate(requestParameters))
      .validateAll();
    return new RequestBuilder(
      HttpMethod.GET,
      Optional.ofNullable(this.config.getBaseUrl()).orElse(Environment.DEFAULT.getUrl()),
      "v3/paymentDunnings/{id}/history"
    )
      .setApiKeyAuth(this.config.getApiKeyAuthConfig())
      .setPathParameter("id", id)
      .setOptionalQueryParameter("offset", requestParameters.getOffset())
      .setOptionalQueryParameter("limit", requestParameters.getLimit())
      .build();
  }

  /**
   * List payments received
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @param requestParameters {@link ListPaymentsReceivedParameters} Request Parameters Object
   * @return response of {@code ApiPaymentDunningListPartialPaymentsResponseDto}
   */
  public ApiPaymentDunningListPartialPaymentsResponseDto listPaymentsReceived(
    @NonNull String id,
    @NonNull ListPaymentsReceivedParameters requestParameters
  ) throws ApiError, ValidationException {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildListPaymentsReceivedRequest(id, requestParameters);
    Response response = this.execute(request);
    return ModelConverter.convert(response, new TypeReference<ApiPaymentDunningListPartialPaymentsResponseDto>() {});
  }

  /**
   * List payments received
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @param requestParameters {@link ListPaymentsReceivedParameters} Request Parameters Object
   * @return response of {@code CompletableFuture<ApiPaymentDunningListPartialPaymentsResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningListPartialPaymentsResponseDto> listPaymentsReceivedAsync(
    @NonNull String id,
    @NonNull ListPaymentsReceivedParameters requestParameters
  ) throws ApiError, ValidationException {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildListPaymentsReceivedRequest(id, requestParameters);
    CompletableFuture<Response> futureResponse = this.executeAsync(request);
    return futureResponse.thenApplyAsync(response ->
      ModelConverter.convert(response, new TypeReference<ApiPaymentDunningListPartialPaymentsResponseDto>() {})
    );
  }

  private Request buildListPaymentsReceivedRequest(
    @NonNull String id,
    @NonNull ListPaymentsReceivedParameters requestParameters
  ) throws ValidationException {
    new ViolationAggregator()
      .add(new ListPaymentsReceivedParametersValidator("requestParameters").optional().validate(requestParameters))
      .validateAll();
    return new RequestBuilder(
      HttpMethod.GET,
      Optional.ofNullable(this.config.getBaseUrl()).orElse(Environment.DEFAULT.getUrl()),
      "v3/paymentDunnings/{id}/partialPayments"
    )
      .setApiKeyAuth(this.config.getApiKeyAuthConfig())
      .setPathParameter("id", id)
      .setOptionalQueryParameter("offset", requestParameters.getOffset())
      .setOptionalQueryParameter("limit", requestParameters.getLimit())
      .build();
  }

  /**
   * List payments available for payment dunning
   *
   * @return response of {@code ApiPaymentDunningPaymentsAvailableForDunningResponseDto}
   */
  public ApiPaymentDunningPaymentsAvailableForDunningResponseDto listPaymentsAvailableForPaymentDunning()
    throws ApiError, ValidationException {
    return this.listPaymentsAvailableForPaymentDunning(
        ListPaymentsAvailableForPaymentDunningParameters.builder().build()
      );
  }

  /**
   * List payments available for payment dunning
   *
   * @param requestParameters {@link ListPaymentsAvailableForPaymentDunningParameters} Request Parameters Object
   * @return response of {@code ApiPaymentDunningPaymentsAvailableForDunningResponseDto}
   */
  public ApiPaymentDunningPaymentsAvailableForDunningResponseDto listPaymentsAvailableForPaymentDunning(
    @NonNull ListPaymentsAvailableForPaymentDunningParameters requestParameters
  ) throws ApiError, ValidationException {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildListPaymentsAvailableForPaymentDunningRequest(requestParameters);
    Response response = this.execute(request);
    return ModelConverter.convert(
      response,
      new TypeReference<ApiPaymentDunningPaymentsAvailableForDunningResponseDto>() {}
    );
  }

  /**
   * List payments available for payment dunning
   *
   * @return response of {@code CompletableFuture<ApiPaymentDunningPaymentsAvailableForDunningResponseDto>}
   */
  public CompletableFuture<
    ApiPaymentDunningPaymentsAvailableForDunningResponseDto
  > listPaymentsAvailableForPaymentDunningAsync() throws ApiError, ValidationException {
    return this.listPaymentsAvailableForPaymentDunningAsync(
        ListPaymentsAvailableForPaymentDunningParameters.builder().build()
      );
  }

  /**
   * List payments available for payment dunning
   *
   * @param requestParameters {@link ListPaymentsAvailableForPaymentDunningParameters} Request Parameters Object
   * @return response of {@code CompletableFuture<ApiPaymentDunningPaymentsAvailableForDunningResponseDto>}
   */
  public CompletableFuture<
    ApiPaymentDunningPaymentsAvailableForDunningResponseDto
  > listPaymentsAvailableForPaymentDunningAsync(
    @NonNull ListPaymentsAvailableForPaymentDunningParameters requestParameters
  ) throws ApiError, ValidationException {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildListPaymentsAvailableForPaymentDunningRequest(requestParameters);
    CompletableFuture<Response> futureResponse = this.executeAsync(request);
    return futureResponse.thenApplyAsync(response ->
      ModelConverter.convert(response, new TypeReference<ApiPaymentDunningPaymentsAvailableForDunningResponseDto>() {})
    );
  }

  private Request buildListPaymentsAvailableForPaymentDunningRequest(
    @NonNull ListPaymentsAvailableForPaymentDunningParameters requestParameters
  ) throws ValidationException {
    new ViolationAggregator()
      .add(
        new ListPaymentsAvailableForPaymentDunningParametersValidator("requestParameters")
          .optional()
          .validate(requestParameters)
      )
      .validateAll();
    return new RequestBuilder(
      HttpMethod.GET,
      Optional.ofNullable(this.config.getBaseUrl()).orElse(Environment.DEFAULT.getUrl()),
      "v3/paymentDunnings/paymentsAvailableForDunning"
    )
      .setApiKeyAuth(this.config.getApiKeyAuthConfig())
      .setOptionalQueryParameter("offset", requestParameters.getOffset())
      .setOptionalQueryParameter("limit", requestParameters.getLimit())
      .build();
  }

  /**
   * Resend documents
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @param apiPaymentDunningSaveDocumentsRequestDto {@link ApiPaymentDunningSaveDocumentsRequestDto} Request Body
   * @return response of {@code ApiPaymentDunningSaveDocumentsResponseDto}
   */
  public ApiPaymentDunningSaveDocumentsResponseDto resendDocuments(
    @NonNull String id,
    @NonNull ApiPaymentDunningSaveDocumentsRequestDto apiPaymentDunningSaveDocumentsRequestDto
  ) throws ApiError {
    return this.resendDocuments(id, apiPaymentDunningSaveDocumentsRequestDto, null);
  }

  /**
   * Resend documents
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @param apiPaymentDunningSaveDocumentsRequestDto {@link ApiPaymentDunningSaveDocumentsRequestDto} Request Body
   * @param _filename String Filename for the uploaded file
   * @return response of {@code ApiPaymentDunningSaveDocumentsResponseDto}
   */
  public ApiPaymentDunningSaveDocumentsResponseDto resendDocuments(
    @NonNull String id,
    @NonNull ApiPaymentDunningSaveDocumentsRequestDto apiPaymentDunningSaveDocumentsRequestDto,
    String _filename
  ) throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildResendDocumentsRequest(id, apiPaymentDunningSaveDocumentsRequestDto, _filename);
    Response response = this.execute(request);
    return ModelConverter.convert(response, new TypeReference<ApiPaymentDunningSaveDocumentsResponseDto>() {});
  }

  /**
   * Resend documents
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @param apiPaymentDunningSaveDocumentsRequestDto {@link ApiPaymentDunningSaveDocumentsRequestDto} Request Body
   * @return response of {@code CompletableFuture<ApiPaymentDunningSaveDocumentsResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningSaveDocumentsResponseDto> resendDocumentsAsync(
    @NonNull String id,
    @NonNull ApiPaymentDunningSaveDocumentsRequestDto apiPaymentDunningSaveDocumentsRequestDto
  ) throws ApiError {
    return this.resendDocumentsAsync(id, apiPaymentDunningSaveDocumentsRequestDto, null);
  }

  /**
   * Resend documents
   *
   * @param id String Unique identifier of the payment dunning in Asaas
   * @param apiPaymentDunningSaveDocumentsRequestDto {@link ApiPaymentDunningSaveDocumentsRequestDto} Request Body
   * @param _filename String Filename for the uploaded file
   * @return response of {@code CompletableFuture<ApiPaymentDunningSaveDocumentsResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningSaveDocumentsResponseDto> resendDocumentsAsync(
    @NonNull String id,
    @NonNull ApiPaymentDunningSaveDocumentsRequestDto apiPaymentDunningSaveDocumentsRequestDto,
    String _filename
  ) throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildResendDocumentsRequest(id, apiPaymentDunningSaveDocumentsRequestDto, _filename);
    CompletableFuture<Response> futureResponse = this.executeAsync(request);
    return futureResponse.thenApplyAsync(response ->
      ModelConverter.convert(response, new TypeReference<ApiPaymentDunningSaveDocumentsResponseDto>() {})
    );
  }

  private Request buildResendDocumentsRequest(
    @NonNull String id,
    @NonNull ApiPaymentDunningSaveDocumentsRequestDto apiPaymentDunningSaveDocumentsRequestDto,
    String _filename
  ) {
    return new RequestBuilder(
      HttpMethod.POST,
      Optional.ofNullable(this.config.getBaseUrl()).orElse(Environment.DEFAULT.getUrl()),
      "v3/paymentDunnings/{id}/documents"
    )
      .setApiKeyAuth(this.config.getApiKeyAuthConfig())
      .setPathParameter("id", id)
      .setBody(
        new MultipartBody.Builder()
          .setType(MultipartBody.FORM)
          .addFormDataPart("id", apiPaymentDunningSaveDocumentsRequestDto.getId())
          .addFormDataPart(
            "documents",
            _filename != null ? _filename : String.format("file_%s", UUID.randomUUID()),
            RequestBody.create(
              apiPaymentDunningSaveDocumentsRequestDto.getDocuments(),
              MediaType.parse("application/octet-stream")
            )
          )
          .build()
      )
      .build();
  }

  /**
   * Cancel payment dunning
   *
   * @param id String Unique identifier of the payment dunning to be cancelled.
   * @param apiPaymentDunningCancelRequestDto {@link ApiPaymentDunningCancelRequestDto} Request Body
   * @return response of {@code ApiPaymentDunningCancelResponseDto}
   */
  public ApiPaymentDunningCancelResponseDto cancelPaymentDunning(
    @NonNull String id,
    @NonNull ApiPaymentDunningCancelRequestDto apiPaymentDunningCancelRequestDto
  ) throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildCancelPaymentDunningRequest(id, apiPaymentDunningCancelRequestDto);
    Response response = this.execute(request);
    return ModelConverter.convert(response, new TypeReference<ApiPaymentDunningCancelResponseDto>() {});
  }

  /**
   * Cancel payment dunning
   *
   * @param id String Unique identifier of the payment dunning to be cancelled.
   * @param apiPaymentDunningCancelRequestDto {@link ApiPaymentDunningCancelRequestDto} Request Body
   * @return response of {@code CompletableFuture<ApiPaymentDunningCancelResponseDto>}
   */
  public CompletableFuture<ApiPaymentDunningCancelResponseDto> cancelPaymentDunningAsync(
    @NonNull String id,
    @NonNull ApiPaymentDunningCancelRequestDto apiPaymentDunningCancelRequestDto
  ) throws ApiError {
    this.addErrorMapping(400, ApiErrorResponseDtoModel.class, ApiErrorResponseDto.class);
    Request request = this.buildCancelPaymentDunningRequest(id, apiPaymentDunningCancelRequestDto);
    CompletableFuture<Response> futureResponse = this.executeAsync(request);
    return futureResponse.thenApplyAsync(response ->
      ModelConverter.convert(response, new TypeReference<ApiPaymentDunningCancelResponseDto>() {})
    );
  }

  private Request buildCancelPaymentDunningRequest(
    @NonNull String id,
    @NonNull ApiPaymentDunningCancelRequestDto apiPaymentDunningCancelRequestDto
  ) {
    return new RequestBuilder(
      HttpMethod.POST,
      Optional.ofNullable(this.config.getBaseUrl()).orElse(Environment.DEFAULT.getUrl()),
      "v3/paymentDunnings/{id}/cancel"
    )
      .setApiKeyAuth(this.config.getApiKeyAuthConfig())
      .setPathParameter("id", id)
      .setJsonContent(apiPaymentDunningCancelRequestDto)
      .build();
  }
}
